#!/bin/bash

PID="$(pidof -o $$ -x ${0##*/})"

if [[ "$PID" ]]; then
    kill -TERM "-$PID"
    exit 1
fi

x=1280
y=1024

modeline="$(cvt $x $y | sed '1d' | sed 's/Modeline //')"
mode="$(echo $modeline | sed 's/ .*//')"

xrandr --newmode $modeline &> /dev/null 2>&1
xrandr --addmode VIRTUAL1 $mode
xrandr --output HDMI1 --auto --output VIRTUAL1 --mode $mode --above LVDS1
optirun screenclone -s $DISPLAY -d :8 -x 1
xrandr --output VIRTUAL1 --off
